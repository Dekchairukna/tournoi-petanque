<!DOCTYPE html>
<html lang="th">

<head>
  <meta charset="UTF-8" />
  <title>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏ö‡∏Ñ‡∏π‡πà - {{ event.name }}</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  
  <style>
    body {
      font-family: "Sarabun", sans-serif;
      background-color: #f8f9fa;
      font-size: 18px;
    }

    @media print {
      @page {
        size: A4 portrait;
        margin-top: 0mm;
        /* ‡∏£‡∏∞‡∏¢‡∏∞‡∏Ç‡∏≠‡∏ö‡∏ö‡∏ô */
        margin-bottom: 0mm;
        /* ‡∏£‡∏∞‡∏¢‡∏∞‡∏Ç‡∏≠‡∏ö‡∏•‡πà‡∏≤‡∏á */
        margin-left: 0mm;
        /* ‡∏ä‡∏¥‡∏î‡∏Ç‡∏≠‡∏ö‡∏ã‡πâ‡∏≤‡∏¢ */
        margin-right: 0mm;
        /* ‡∏ä‡∏¥‡∏î‡∏Ç‡∏≠‡∏ö‡∏Ç‡∏ß‡∏≤ */
      }

      html,
      body {
        margin: 0;
        padding: 0;
        background-color: white !important;
        color: #000 !important;
        width: 100%;
      }

      /* ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á container ‡πÅ‡∏•‡∏∞ card ‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡πá‡∏° */
      .container,
      .card,
      .row,
      .col,
      main,
      section {
        margin-left: 0 !important;
        margin-right: 0 !important;
        padding-left: 0 !important;
        padding-right: 0 !important;
        max-width: 100% !important;
        width: 100% !important;
        box-shadow: none !important;
        border: none !important;
        page-break-inside: avoid;
      }


      .no-print {
        display: none !important;
      }

      body {
        background-color: white !important;
        color: #000 !important;
      }

      .print-table thead {
        display: table-header-group;
      }

      .card {
        box-shadow: none !important;
        border: none !important;
      }
    }

    th,
    td {
      vertical-align: middle !important;
      border: 1px solid #dee2e6;
    }

    table {
      border-collapse: collapse;
      width: 100%;
    }

    @media print {
      .page-break {
        page-break-before: always;
      }

      .page-break:first-child {
        page-break-before: avoid;
      }

      .container>.card {
        page-break-after: always;
        page-break-inside: avoid;
      }

      .container>.card:last-child {
        page-break-after: auto;
      }
    }

    table tbody tr {
      border-top: 1px solid #dee2e6;
      border-bottom: 1px solid #dee2e6;
    }

    .logo-on-sheet {
      max-height: 50px;
      margin-right: 15px;
    }
  </style>
</head>

<body>
  <div class="container py-4">
    <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå -->
    <div class="d-flex justify-content-end align-items-center gap-2 mb-3 no-print flex-wrap">

  <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏†‡∏≤‡∏û -->
  <button class="btn btn-success btn-lg" onclick="saveFullPageImage()">
    üì∑ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏†‡∏≤‡∏û‡∏ó‡∏∏‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á
  </button>

  <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå -->
  <button class="btn btn-dark btn-lg" onclick="window.print()">
    üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏ö‡∏Ñ‡∏π‡πà
  </button>
  
  <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏±‡∏ö -->
  <a href="{{ url_for('event_detail', event_id=event.id) }}" class="btn btn-secondary btn-lg">
    ‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô
  </a>

</div>


    <!-- ‡∏ß‡∏ô‡∏£‡∏≠‡∏ö‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô -->
    {% for round_number, matches in matches_by_round.items() %}
    <div class="card shadow-lg rounded-4 mb-0 margin-top: -0.25rem !important">
      <div class="card-body">
        <div class="table-responsive">
          <table class="table table-striped print-table align-middle">
            <thead class="text-center table-dark">
              <tr>
                <th colspan="5" class="bg-white text-dark text-center border-0 p-3">

                  {% for logo in event.logo_list %}
                  <img src="{{ url_for('static', filename='logos/' + logo) }}" class="logo-on-sheet mb-1"
                    alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏Ç‡∏≠‡∏á {{ event.name }}" />
                  {% endfor %}
                  <h3 class="fw-bold mb-1">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏ö‡∏Ñ‡∏π‡πà</h3>
                  <h4 class="fw-bold mb-1">{{ event.name }}</h4>
                  <h4 class="fw-bold mb-1">‡∏ì {{ event.location }} | {{ thai_date_full(event.date) }}</h5>
                    <h5 class="fw-bold mb-1"> ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó {{ event.category }} ‡πÄ‡∏û‡∏® {{ event.sex }} ‡∏£‡∏∏‡πà‡∏ô {{ event.age_group }} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà {{
                      round_number }}</h5>
                </th>
              </tr>
              <tr>
                <th style="width: 10%">‡∏™‡∏ô‡∏≤‡∏°</th>
                <th style="width: 30%">‡∏ó‡∏µ‡∏°</th>
                <th style="width: 30%">‡∏ó‡∏µ‡∏°</th>
                <th style="width: 10%">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th>
                <th style="width: 10%">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th>

              </tr>
            </thead>
            <tbody>
              {% for match in matches %}
              <tr class="text-center">
                <td class="text-center fw-bold">{{ match.field or '-' }}</td>
                <td>{{ teams.get(match.team1_id, 'BYE') }}</td>
                <td>{{ teams.get(match.team2_id, 'BYE') }}</td>
                <td class="text-center">{{ match.team1_score if match.team1_score is not none else '-' }}</td>
                <td class="text-center">{{ match.team2_score if match.team2_score is not none else '-' }}</td>

              </tr>
              {% else %}
              <tr>
                <td colspan="5" class="text-center text-muted">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏π‡πà‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
    {% endfor %}


  </div>
</body>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<script>
  function saveFullPageImage() {
    const element = document.querySelector('.card.shadow-lg.rounded-4'); // ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏ó‡∏∏‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≠‡∏ö
    html2canvas(element, {
      useCORS: true,
      scale: 2,
      backgroundColor: '#ffffff'
    }).then(canvas => {
      const link = document.createElement('a');
      // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏ö‡∏ö‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÇ‡∏î‡∏¢‡πÅ‡∏ó‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢ _ 
      const filename = '‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏ö‡∏Ñ‡∏π‡πà_{{ event.name|replace(" ", "_") }}_‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó_{{ event.category|replace(" ", "_") }}_‡∏£‡∏∏‡πà‡∏ô_{{ event.age_group|replace(" ", "_") }}.png';
      link.download = filename;
      link.href = canvas.toDataURL('image/png');
      link.click();
    });
  }
</script>



</html>
